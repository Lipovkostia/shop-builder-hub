
# –ü–ª–∞–Ω: –î–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–µ

## –ó–∞–¥–∞—á–∞
–î–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞:
1. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è** (–Ω–æ–≤—ã–π) - –¥–ª—è –≤—ã–±–æ—Ä–∞ –≥–ª–∞–≤–Ω–æ–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è
2. **–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è** (—Ç–µ–∫—É—â–∏–π —Å—Ç–æ–ª–±–µ—Ü "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏" –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω) - –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
- –í —Ç–∞–±–ª–∏—Ü–µ `catalog_product_settings` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ `categories`
- –ù–µ—Ç –ø–æ–ª—è `primary_category_id` –¥–ª—è –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –í –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–µ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏" —Å –º—É–ª—å—Ç–∏-–≤—ã–±–æ—Ä–æ–º

## –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
| –§–æ—Ç–æ | –ù–∞–∑–≤–∞–Ω–∏–µ        | –ö–∞—Ç–µ–≥–æ—Ä–∏—è          | –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è              | –ï–¥.–∏–∑–º |
|------|-----------------|---------------------|---------------------------|--------|
| üì∑   | –ü–∞—Ä–º–µ–∑–∞–Ω        | [‚ñº –°—ã—Ä—ã           ]| [–¢–≤—ë—Ä–¥—ã–µ] [–ò—Ç–∞–ª–∏—è]        | –∫–≥     |
| üì∑   | –•–∞–º–æ–Ω –°–µ—Ä—Ä–∞–Ω–æ   | [‚ñº –ú—è—Å–æ           ]| [–•–∞–º–æ–Ω—ã] [–ò—Å–ø–∞–Ω–∏—è]        | –∫–≥     |
| üì∑   | –§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è     | [‚ñº –ú–æ–ª–æ—á–∫–∞        ]| [–ú—è–≥–∫–∏–π —Å—ã—Ä] [–ü–æ—Ä—Ü–∏–æ–Ω–Ω—ã–µ] | –∫–≥     |
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –≠—Ç–∞–ø 1: –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –ø–æ–ª–µ `primary_category_id` –≤ —Ç–∞–±–ª–∏—Ü—É `catalog_product_settings`:

```sql
ALTER TABLE catalog_product_settings 
ADD COLUMN primary_category_id uuid REFERENCES categories(id) ON DELETE SET NULL;

COMMENT ON COLUMN catalog_product_settings.primary_category_id 
IS 'Main parent category for display grouping. Subcategories go in categories array.';

-- –ú–∏–≥—Ä–∞—Ü–∏—è: –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ categories —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è primary_category_id
UPDATE catalog_product_settings 
SET primary_category_id = categories[1]::uuid
WHERE categories IS NOT NULL 
  AND array_length(categories, 1) > 0;
```

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ InlinePrimaryCategoryCell

–ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `src/components/admin/InlinePrimaryCategoryCell.tsx` –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–¥–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:

- Select-dropdown –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è (–≥–¥–µ `parent_id IS NULL`)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø—Ü–∏–π: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### –≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ useCatalogProductSettings

–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `CatalogProductSetting`:
```typescript
interface CatalogProductSetting {
  // ... existing fields
  primary_category_id: string | null;  // NEW
}
```

–û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `formatSetting()` –∏ `updateProductSettings()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤—ã–º –ø–æ–ª–µ–º.

### –≠—Ç–∞–ø 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ AdminPanel.tsx

1. **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É –≤ catalogVisibleColumns:**
```typescript
const [catalogVisibleColumns, setCatalogVisibleColumns] = useState({
  // ...existing
  primaryCategory: true,  // NEW - –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ categories
  categories: true,       // renamed to "–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è"
});

const catalogColumnLabels = {
  // ...existing
  primaryCategory: "–ö–∞—Ç–µ–≥–æ—Ä–∏—è",  // NEW
  categories: "–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è",    // renamed
};
```

2. **–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏**

3. **–û–±–Ω–æ–≤–∏—Ç—å InlineMultiSelectCell –¥–ª—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
   - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –æ–ø—Ü–∏–∏: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–æ—á–µ—Ä–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π
   - –ï—Å–ª–∏ –≥–ª–∞–≤–Ω–∞—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### –≠—Ç–∞–ø 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ BulkEditPanel

–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—Å–æ–≤–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≥–ª–∞–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é:
- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "–ö–∞—Ç–µ–≥–æ—Ä–∏—è" —Ä—è–¥–æ–º —Å —Ç–µ–∫—É—â–µ–π "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"
- Dropdown –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–¥–Ω–æ–π –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è

| –§–∞–π–ª | –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î | –°–æ–∑–¥–∞—Ç—å | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `primary_category_id` |
| `src/components/admin/InlinePrimaryCategoryCell.tsx` | –°–æ–∑–¥–∞—Ç—å | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| `src/hooks/useCatalogProductSettings.ts` | –ò–∑–º–µ–Ω–∏—Ç—å | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –º–µ—Ç–æ–¥—ã |
| `src/pages/AdminPanel.tsx` | –ò–∑–º–µ–Ω–∏—Ç—å | –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é |
| `src/components/admin/BulkEditPanel.tsx` | –ò–∑–º–µ–Ω–∏—Ç—å | –î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |

## –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π

```typescript
// –í —è—á–µ–π–∫–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–æ—á–µ—Ä–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const subcategoryOptions = useMemo(() => {
  if (!primaryCategoryId) {
    // –ï—Å–ª–∏ –≥–ª–∞–≤–Ω–∞—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –Ω–µ-–∫–æ—Ä–Ω–µ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return categories.filter(c => c.parent_id !== null);
  }
  // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–æ—á–µ—Ä–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π
  return categories.filter(c => c.parent_id === primaryCategoryId);
}, [categories, primaryCategoryId]);
```

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `primary_category_id`)
2. –û–±–Ω–æ–≤–∏—Ç—å `useCatalogProductSettings.ts` (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
3. –°–æ–∑–¥–∞—Ç—å `InlinePrimaryCategoryCell.tsx`
4. –û–±–Ω–æ–≤–∏—Ç—å `AdminPanel.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é)
5. –û–±–Ω–æ–≤–∏—Ç—å `BulkEditPanel.tsx` (–º–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
