
# Исправление экспорта/импорта категорий в прайс-листе

## Проблема

При экспорте прайс-листа в Excel в колонке "Категории" отображаются UUID (например `a0483c51-b9a5-4754-b9d4-a1f1a2141bf2`) вместо русских названий категорий.

## Корневая причина

В `AdminPanel.tsx` (строка 1789) категории берутся как массив UUID из `catalogPricing?.categories`, а в `excelImport.ts` (строка 1401) они просто соединяются через запятую без преобразования в имена.

## Решение

### 1. AdminPanel.tsx -- преобразовать UUID в названия при экспорте

В блоке формирования `catalogProducts` (около строки 1785-1802) нужно заменить UUID категорий на их названия, используя уже загруженный список категорий (`categories` из `useStoreCategories`).

```typescript
// Было:
categories: catalogPricing?.categories || null,

// Станет:
categories: (catalogPricing?.categories || [])
  .map(catId => categories.find(c => c.id === catId)?.name)
  .filter(Boolean) as string[] | null,
```

Если массив пуст -- вернуть `null`.

### 2. excelImport.ts -- обновить разделитель при парсинге категорий

Функция `parseCategories` (строка 1028) сейчас разделяет по точке с запятой (`;`), а экспорт соединяет через запятую (`, `). Нужно поддержать оба разделителя:

```typescript
function parseCategories(categoriesStr: string | undefined): string[] {
  if (!categoriesStr) return [];
  // Поддержка разделителей: запятая и точка с запятой
  return categoriesStr
    .split(/[;,]/)
    .map(c => c.trim())
    .filter(Boolean);
}
```

### Файлы для изменения

| Файл | Что меняется |
|------|-------------|
| `src/pages/AdminPanel.tsx` | Строка ~1789: маппинг UUID категорий в названия |
| `src/lib/excelImport.ts` | Строка ~1030: поддержка запятой как разделителя категорий |

### Результат

- Экспорт: колонка "Категории" будет содержать `Порционный сыр, Вкусовые сыры с добавками` вместо UUID
- Импорт: при загрузке файла обратно категории распознаются по названиям (уже работает), создаются новые если не найдены
- Разделитель запятая поддерживается в обе стороны
