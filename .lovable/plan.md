

# План: Исправление импорта отпускной цены (поле "Цена") из Excel

## Описание проблемы
При импорте из Excel с выбранным полем "Цена" (отпускная цена) без "Себестоимость" кнопка "Импортировать" не работает, потому что проверка в коде не учитывает поле `price`.

## Причина
В файле `AIAssistantPanel.tsx` (строка 439) есть проверка:
```typescript
const hasFieldToUpdate = fieldsToUpdate.buyPrice !== null || fieldsToUpdate.unit !== null || fieldsToUpdate.name !== null;
```
Поле `price` отсутствует в этой проверке, поэтому система считает, что нечего обновлять.

## Решение

### 1. AIAssistantPanel.tsx — исправить проверку на наличие полей для обновления

Добавить `fieldsToUpdate.price` в проверку:

```typescript
// Строка 439
const hasFieldToUpdate = 
  fieldsToUpdate.buyPrice !== null || 
  fieldsToUpdate.price !== null ||      // Добавить эту проверку
  fieldsToUpdate.unit !== null || 
  fieldsToUpdate.name !== null;
```

## Результат
После исправления:
- Пользователь сможет выбрать только поле "Цена" и успешно импортировать
- Отпускная цена будет обновляться независимо от себестоимости
- Импорт будет работать с любой комбинацией полей

## Дополнительные улучшения (опционально)

### Умный функционал — автоматический расчёт наценки
Можно добавить дополнительную логику при импорте:
- Если указаны и себестоимость и цена → автоматически рассчитать наценку
- Формула: `markup_value = ((price / buyPrice) - 1) * 100`
- Это позволит сохранять наценку для будущих пересчётов при изменении себестоимости

### Предпросмотр в диалоге
Убедиться, что в предпросмотре данных корректно отображается колонка "Цена" с её значениями (уже работает, так как используется общий механизм `selectedUpdateColumns`).

