

# ĞŸĞ»Ğ°Ğ½: ĞŸĞ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ½Ğ° Ğ²Ğ¸Ñ‚Ñ€Ğ¸Ğ½Ğµ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ°

## ĞĞ±Ğ·Ğ¾Ñ€

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¹ (Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¹) ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¸ ÑĞ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¸Ñ… Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ĞµĞµ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ².

## Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ

- Ğ’ Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»Ğµ `parent_id` ÑƒĞ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ `categories`
- Ğ¥ÑƒĞºĞ¸ `useStoreCategories` Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ `parent_id`
- Ğ’Ğ¸Ñ‚Ñ€Ğ¸Ğ½Ñ‹ (`RetailStore`, `WholesaleStore`) Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ
- ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ `RetailLayoutSidebar` Ğ¸Ğ¼ĞµĞµÑ‚ Ğ·Ğ°Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºÑƒ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ (`hasChildren = false`)

## Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

### Ğ Ğ¾Ğ·Ğ½Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ²Ğ¸Ñ‚Ñ€Ğ¸Ğ½Ğ° (Desktop sidebar)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸª ĞœĞĞ“ĞĞ—Ğ˜Ğ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ğ’ÑĞµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹                  â”‚
â”‚                             â”‚
â”‚ â–¼ ĞœÑÑĞ¾                      â”‚  â† Ğ Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ°Ñ (ĞºĞ»Ğ¸ĞºĞ°Ğ±ĞµĞ»ÑŒĞ½Ğ°)
â”‚   â”œâ”€ Ğ“Ğ¾Ğ²ÑĞ´Ğ¸Ğ½Ğ°              â”‚  â† ĞŸĞ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ
â”‚   â”œâ”€ Ğ¡Ğ²Ğ¸Ğ½Ğ¸Ğ½Ğ°               â”‚
â”‚   â””â”€ ĞŸÑ‚Ğ¸Ñ†Ğ°                 â”‚
â”‚                             â”‚
â”‚ â€º Ğ¡Ñ‹Ñ€Ñ‹                      â”‚  â† Ğ¡Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ° (ĞµÑÑ‚ÑŒ Ğ´ĞµÑ‚Ğ¸)
â”‚                             â”‚
â”‚ ĞĞ°Ğ¿Ğ¸Ñ‚ĞºĞ¸                     â”‚  â† Ğ‘ĞµĞ· Ğ´ĞµÑ‚ĞµĞ¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞœĞ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ (Sheet)

```text
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ â–”â–”â–”â–”â–”                                    â”‚
â”‚ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ                       â”‚
â”‚ ğŸ” ĞŸĞ¾Ğ¸ÑĞº...                              â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ âœ“ Ğ’ÑĞµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹                        156  â”‚
â”‚                                          â”‚
â”‚ â–¼ ĞœÑÑĞ¾                               45  â”‚  â† Ğ Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ°
â”‚     Ğ“Ğ¾Ğ²ÑĞ´Ğ¸Ğ½Ğ°                         15  â”‚
â”‚     Ğ¡Ğ²Ğ¸Ğ½Ğ¸Ğ½Ğ°                          18  â”‚
â”‚     ĞŸÑ‚Ğ¸Ñ†Ğ°                            12  â”‚
â”‚                                          â”‚
â”‚ â€º Ğ¡Ñ‹Ñ€Ñ‹                               32  â”‚  â† Ğ¡Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ğ°
â”‚                                          â”‚
â”‚ ĞĞ°Ğ¿Ğ¸Ñ‚ĞºĞ¸                              28  â”‚  â† Ğ‘ĞµĞ· Ğ´ĞµÑ‚ĞµĞ¹
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

### ĞĞ¿Ñ‚Ğ¾Ğ²Ğ°Ñ Ğ²Ğ¸Ñ‚Ñ€Ğ¸Ğ½Ğ° (Dropdown selector)

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ñ‡Ğ¸Ğ¿Ñ‹ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“ ĞœÑÑĞ¾ (45) â–¼]                                        â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸:                                           â”‚
â”‚ [Ğ“Ğ¾Ğ²ÑĞ´Ğ¸Ğ½Ğ° (15)] [Ğ¡Ğ²Ğ¸Ğ½Ğ¸Ğ½Ğ° (18)] [ĞŸÑ‚Ğ¸Ñ†Ğ° (12)]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

### Ğ­Ñ‚Ğ°Ğ¿ 1: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `parent_id` Ğ² Ñ‚Ğ¸Ğ¿Ñ‹ `RetailCategory` Ğ¸ `WholesaleCategory`:

```typescript
// useRetailStore.ts
export interface RetailCategory {
  id: string;
  name: string;
  slug: string;
  image_url: string | null;
  parent_id: string | null;  // NEW
  product_count?: number;
}
```

### Ğ­Ñ‚Ğ°Ğ¿ 2: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹

Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ² `useRetailStore.ts` Ğ¸ `useWholesaleStore.ts` Ğ´Ğ»Ñ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ `parent_id`:

```typescript
const { data } = await supabase
  .from("categories")
  .select("id, name, slug, image_url, parent_id")  // Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ parent_id
  .eq("store_id", store.id)
  .order("sort_order");
```

### Ğ­Ñ‚Ğ°Ğ¿ 3: ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ´ĞµÑ€ĞµĞ²Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñƒ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ğ¸:

```typescript
interface CategoryTree extends RetailCategory {
  children: CategoryTree[];
}

function buildCategoryTree(categories: RetailCategory[]): CategoryTree[] {
  const map = new Map<string, CategoryTree>();
  const roots: CategoryTree[] = [];

  // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑƒĞ·Ğ»Ğ¾Ğ²
  categories.forEach(cat => {
    map.set(cat.id, { ...cat, children: [] });
  });

  // ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ´ĞµÑ€ĞµĞ²Ğ°
  categories.forEach(cat => {
    const node = map.get(cat.id)!;
    if (cat.parent_id && map.has(cat.parent_id)) {
      map.get(cat.parent_id)!.children.push(node);
    } else {
      roots.push(node);
    }
  });

  return roots;
}
```

### Ğ­Ñ‚Ğ°Ğ¿ 4: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ RetailLayoutSidebar

```typescript
// ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ´ĞµÑ€ĞµĞ²Ğ¾ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·
const categoryTree = useMemo(() => 
  buildCategoryTree(categoriesWithProducts), 
  [categoriesWithProducts]
);

// Ğ ĞµĞºÑƒÑ€ÑĞ¸Ğ²Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ½Ğ³
function renderCategory(cat: CategoryTree, depth = 0) {
  const hasChildren = cat.children.length > 0;
  const isExpanded = expandedCategories.includes(cat.id);
  const isSelected = selectedCategory === cat.id;

  return (
    <div key={cat.id} style={{ marginLeft: depth * 16 }}>
      <button onClick={() => {
        onCategorySelect(cat.id);
        if (hasChildren) toggleExpanded(cat.id);
      }}>
        {hasChildren && (isExpanded ? <ChevronDown/> : <ChevronRight/>)}
        {cat.name}
      </button>
      
      {hasChildren && isExpanded && (
        <div className="border-l pl-4">
          {cat.children.map(child => renderCategory(child, depth + 1))}
        </div>
      )}
    </div>
  );
}
```

### Ğ­Ñ‚Ğ°Ğ¿ 5: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ RetailCatalogSheet (Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ)

ĞĞ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Sheet:
- ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ñ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ğ°Ğ¼Ğ¸
- ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ñ/ÑĞ²Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ»Ñ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹
- ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ´ĞµÑ‚ĞµĞ¹

### Ğ­Ñ‚Ğ°Ğ¿ 6: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ WholesaleCategorySelector

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ñ‡Ğ¸Ğ¿Ñ‹ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ¼:

```typescript
// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
const subcategories = useMemo(() => {
  if (!selectedCategory) return [];
  return categories.filter(c => c.parent_id === selectedCategory);
}, [categories, selectedCategory]);

// Ğ ĞµĞ½Ğ´ĞµÑ€ Ñ‡Ğ¸Ğ¿Ğ¾Ğ² Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹
{subcategories.length > 0 && (
  <div className="flex flex-wrap gap-2 mt-2">
    {subcategories.map(sub => (
      <Button
        key={sub.id}
        variant={selectedCategory === sub.id ? "default" : "outline"}
        size="sm"
        onClick={() => onSelectCategory(sub.id)}
      >
        {sub.name} ({sub.product_count})
      </Button>
    ))}
  </div>
)}
```

### Ğ­Ñ‚Ğ°Ğ¿ 7: Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ğ¸

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹ Ğ¸Ğ· Ğ½ĞµÑ‘ Ğ˜ Ğ¸Ğ· Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹:

```typescript
const getDescendantIds = (categoryId: string): string[] => {
  const descendants: string[] = [categoryId];
  const children = categories.filter(c => c.parent_id === categoryId);
  children.forEach(child => {
    descendants.push(...getDescendantIds(child.id));
  });
  return descendants;
};

// Ğ’ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
if (selectedCategory) {
  const relevantCategoryIds = getDescendantIds(selectedCategory);
  result = result.filter((p) => 
    relevantCategoryIds.some(catId => 
      p.category_ids.includes(catId) || p.category_id === catId
    )
  );
}
```

## Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

| Ğ¤Ğ°Ğ¹Ğ» | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|------|----------|----------|
| `src/hooks/useRetailStore.ts` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `parent_id` Ğ² Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ |
| `src/hooks/useWholesaleStore.ts` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `parent_id` Ğ² Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ |
| `src/lib/categoryUtils.ts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ´ĞµÑ€ĞµĞ²Ğ¾Ğ¼ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ |
| `src/components/retail/RetailLayoutSidebar.tsx` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ ĞµĞºÑƒÑ€ÑĞ¸Ğ²Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ½Ğ³ Ğ´ĞµÑ€ĞµĞ²Ğ° |
| `src/components/retail/RetailCatalogSheet.tsx` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ² Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Sheet |
| `src/components/wholesale/WholesaleCategorySelector.tsx` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | ĞŸĞ¾ĞºĞ°Ğ· Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ Ñ‡Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ |
| `src/pages/RetailStore.tsx` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ |
| `src/pages/WholesaleStore.tsx` | Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ | Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ |

## ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğµ Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ (Ñ‡ĞµÑ€ĞµĞ· URL Ğ¸Ğ»Ğ¸ Ğ¿Ñ€ÑĞ¼Ğ¾Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€) Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°Ñ‚ÑŒ ĞµÑ‘ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºÑƒÑ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ:

```typescript
useEffect(() => {
  if (selectedCategory) {
    const selected = categories.find(c => c.id === selectedCategory);
    if (selected?.parent_id) {
      setExpandedCategories(prev => 
        prev.includes(selected.parent_id!) 
          ? prev 
          : [...prev, selected.parent_id!]
      );
    }
  }
}, [selectedCategory, categories]);
```

## ĞŸĞ¾Ğ´ÑÑ‡Ñ‘Ñ‚ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²

Ğ”Ğ»Ñ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑÑƒĞ¼Ğ¼Ñƒ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ² Ğ¸Ğ· Ğ²ÑĞµÑ… Ğ´Ğ¾Ñ‡ĞµÑ€Ğ½Ğ¸Ñ…:

```typescript
const getTotalProductCount = (categoryId: string): number => {
  const category = categories.find(c => c.id === categoryId);
  const directCount = category?.product_count || 0;
  const children = categories.filter(c => c.parent_id === categoryId);
  const childrenCount = children.reduce(
    (sum, child) => sum + getTotalProductCount(child.id), 
    0
  );
  return directCount + childrenCount;
};
```

