
Контекст по скрину и почему так происходит
- Вы смотрите не “публичную розничную витрину” (страница RetailStore), а “витрину внутри кабинета продавца” (страница StoreFront в SellerWorkspace).
- Для публичной розничной витрины мы уже поправили backend-функцию `get_retail_products_public`, чтобы она учитывала `is_fixed_price`.
- Но в кабинете продавца витрина считает цену на фронтенде в `src/pages/StoreFront.tsx` и сейчас там логика всегда опирается на `buy_price` (+ наценка), игнорируя `is_fixed_price`. Поэтому, даже если “Цена” = 8888 и стоит замок, карточка на витрине показывает 3 (себестоимость) или цену от неё.

Цель
- Если у товара стоит замок (флаг `is_fixed_price = true`) и заполнена “Цена” (`price > 0`), то в витрине кабинета продавца показывать именно `price` и не рассчитывать цену от `buy_price`/наценки.

Что именно изменим (frontend)
1) Исправить расчёт `salePrice` в `src/pages/StoreFront.tsx` (в компоненте карточки товара, который начинается примерно около строк 120+)
   - Сейчас:
     - `buyPrice = product.buy_price || product.price`
     - `salePrice = calculateSalePrice(buyPrice, markup) || product.price`
     - Это приводит к тому, что если `buy_price` есть (например 3), то salePrice становится 3 даже при наличии фиксированной “Цена” 8888.
   - Сделаем:
     - Ввести проверку `const isFixed = product.is_fixed_price === true`
     - Если `isFixed && product.price != null && product.price > 0`:
       - `salePrice = product.price`
       - и дальше все производные цены (упаковка/полная цена) считаются от этого `salePrice`
     - Иначе (не фиксированная цена):
       - вычислять `salePrice` по текущей логике от `buy_price` + наценка (каталожная или товарная), с аккуратным fallback на `product.price`.

2) Проверить, что все места отображения цены внутри StoreFront используют именно `salePrice`
   - В этом файле от `salePrice` уже считаются `packagingPrices` и `fullPrice`, поэтому после пункта (1) визуально должно сразу стать корректно.
   - Если найдём ещё “сырой” вывод `product.buy_price`/`product.price` в тексте карточки (не через `salePrice`), заменим на `salePrice` там же в `StoreFront.tsx`.

Что изменим (backend) — не требуется
- Для публичной розничной витрины backend-логика уже обновлена.
- Эта проблема на скрине именно про кабинет/витрину продавца, там цена считается на клиенте.

Проверка после изменений (обязательно)
1) В админке:
   - У товара “Альпийский цветок” убедиться, что:
     - “Цена” = 8888
     - замок включён (is_fixed_price = true)
     - “Себестоимость” = 3 (или любая другая)
2) В витрине кабинета продавца (вкладка “Витрина” внутри workspace):
   - Убедиться, что на карточке/в списке показывается 8888, а не 3.
3) Дополнительно:
   - Выключить замок у этого товара и убедиться, что цена снова становится расчётной (от себестоимости/наценки) — чтобы не сломать текущую логику.

Файлы, которые будем менять
- `src/pages/StoreFront.tsx`

Риски и нюансы
- Если для некоторых каталогов у вас задана наценка, то при выключенном замке цена продолжит считаться от себестоимости — это ожидаемое поведение.
- При включенном замке мы намеренно игнорируем себестоимость и наценки, чтобы “Цена” стала источником правды (как вы и ожидаете).
